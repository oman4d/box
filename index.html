<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ­Ø¯ÙŠ Ø§Ù„ÙƒÙŠÙ…ÙŠØ§Ø¡ - Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø´ÙŠØ® Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø¨Ù† Ø¨Ø´ÙŠØ± Ø§Ù„Ø­Ø¶Ø±Ù…ÙŠ</title>
    <style>
        :root {
            --bg-color: #1e272e;
            --text-color: #ffdd59;
            --line-color: #485460;
            --chest-wood: #8d5524;
            --gold: #ffd700;
            --accent: #ef5777;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden; /* ÙŠÙ…Ù†Ø¹ Ø§Ù„ØªÙ…Ø±ÙŠØ± */
        }

        /* --- Ø§Ù„ØªØ±ÙˆÙŠØ³Ø© Ø§Ù„Ù…Ø¹Ø¯Ù„Ø© --- */
        header {
            width: 100%;
            display: flex;
            justify-content: space-between; /* ÙŠÙˆØ²Ø¹ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø£Ù‚ØµÙ‰ Ø§Ù„ÙŠÙ…ÙŠÙ† ÙˆØ£Ù‚ØµÙ‰ Ø§Ù„ÙŠØ³Ø§Ø± */
            align-items: center;
            padding: 15px 40px; /* Ù…Ø³Ø§Ø­Ø© Ø¯Ø§Ø®Ù„ÙŠØ© */
            background: rgba(0,0,0,0.3);
            border-bottom: 2px solid var(--line-color);
            box-sizing: border-box; /* Ù„Ø¶Ù…Ø§Ù† Ø¹Ø¯Ù… Ø®Ø±ÙˆØ¬ Ø§Ù„Ø¨Ø§Ø¯ÙŠÙ†Ø¬ Ø¹Ù† Ø§Ù„Ø¹Ø±Ø¶ */
        }

        .school-name {
            font-size: 26px;
            color: white;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
            font-weight: bold;
        }

        .developer-name {
            font-size: 20px; /* ØªÙƒØ¨ÙŠØ± Ø§Ù„Ø®Ø· */
            color: var(--gold); /* Ù„ÙˆÙ† Ø°Ù‡Ø¨ÙŠ Ù…Ù…ÙŠØ² */
            font-weight: bold;
            background: rgba(255, 255, 255, 0.1);
            padding: 5px 15px;
            border-radius: 20px;
            border: 1px solid var(--gold);
        }

        /* --- Ø§Ù„Ù…Ø¤Ù‚Øª Ø§Ù„Ø¯Ø§Ø¦Ø±ÙŠ --- */
        .timer-container {
            position: relative;
            width: 120px;
            height: 120px;
            margin: 20px auto 10px auto;
        }

        .timer-svg {
            transform: rotate(-90deg);
            width: 100%;
            height: 100%;
        }

        .circle-bg {
            fill: none;
            stroke: #485460;
            stroke-width: 8;
        }

        .circle-progress {
            fill: none;
            stroke: var(--accent);
            stroke-width: 8;
            stroke-dasharray: 283;
            stroke-dashoffset: 0;
            transition: stroke-dashoffset 1s linear;
        }

        .timer-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 28px;
            font-weight: bold;
            color: white;
            font-family: monospace;
        }

        /* --- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø£Ù„ØºØ§Ø² --- */
        .puzzle-area {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            gap: 30px;
            margin-top: 20px;
            width: 100%;
            max-width: 900px;
        }

        .column {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 220px;
            position: relative;
        }

        /* ØµÙ†Ø§Ø¯ÙŠÙ‚ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© */
        .question-box {
            background: #d2dae2;
            color: #1e272e;
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            font-size: 15px;
            font-weight: bold;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            border: 2px solid var(--gold);
            min-height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            z-index: 10;
        }

        /* Ø§Ù„Ø®Ø· Ø§Ù„Ø·ÙˆÙŠÙ„ */
        .long-line {
            width: 6px;
            height: 140px; /* Ø²ÙŠØ§Ø¯Ø© Ø·ÙˆÙ„ Ø§Ù„Ø®Ø· */
            background: linear-gradient(to bottom, var(--gold), var(--line-color));
            margin-top: -5px;
            z-index: 1;
        }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù‚ÙÙ„ Ø§Ù„Ù…Ø¬Ù…Ø¹ */
        .lock-housing {
            background: #2f3640;
            padding: 20px 30px;
            border-radius: 15px;
            display: flex;
            gap: 15px;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.8), 0 5px 15px rgba(0,0,0,0.5);
            border: 4px solid #576574;
            margin-top: -10px; /* ØªØ¯Ø§Ø®Ù„ Ù…Ø¹ Ø§Ù„Ø®Ø·ÙˆØ· */
            z-index: 5;
            position: relative;
        }

        .code-input {
            width: 60px;
            height: 70px;
            font-size: 36px;
            text-align: center;
            border: 3px solid #576574;
            border-radius: 8px;
            background: #000;
            color: var(--accent);
            font-family: 'Courier New', Courier, monospace;
            outline: none;
        }

        .code-input:focus { border-color: var(--gold); box-shadow: 0 0 10px var(--gold); }

        /* --- ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„ÙƒÙ†Ø² --- */
        .chest-wrapper {
            margin-top: 20px;
            perspective: 800px;
            position: relative;
            height: 150px;
            width: 220px;
            display: flex;
            justify-content: center;
        }

        .chest-body {
            width: 200px;
            height: 110px;
            background: var(--chest-wood);
            border: 5px solid #5e3717;
            position: absolute;
            bottom: 0;
            border-radius: 0 0 15px 15px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.6);
        }

        .chest-lid {
            width: 200px;
            height: 60px;
            background: var(--chest-wood);
            border: 5px solid #5e3717;
            border-radius: 15px 15px 0 0;
            position: absolute;
            top: 35px;
            transform-origin: top;
            transition: transform 0.8s ease-in-out, top 0.8s;
            z-index: 5;
        }

        .chest-lock {
            width: 30px;
            height: 40px;
            background: var(--gold);
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 5px;
            border: 2px solid #b8860b;
        }

        /* Ø²Ø± Ø§Ù„ÙØªØ­ */
        .submit-btn {
            margin-top: 20px;
            padding: 12px 50px;
            background: linear-gradient(45deg, #ffd700, #f1c40f);
            color: #1e272e;
            border: none;
            font-weight: bold;
            font-size: 20px;
            cursor: pointer;
            border-radius: 30px;
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.4);
            transition: transform 0.2s;
        }
        .submit-btn:hover { transform: scale(1.05); }

        /* ØªØ£Ø«ÙŠØ± Ø§Ù„ÙØªØ­ */
        .chest-open .chest-lid {
            transform: rotateX(120deg);
            top: 10px;
        }
        
        .success-msg {
            position: absolute;
            top: -20px;
            color: #4cd137;
            font-size: 24px;
            font-weight: bold;
            opacity: 0;
            transition: 0.5s;
            text-shadow: 0 2px 4px rgba(0,0,0,1);
            z-index: 20;
        }
        .chest-open .success-msg { opacity: 1; top: -50px; }

        /* Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© */
        #start-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        #start-btn {
            padding: 20px 60px;
            font-size: 28px;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 0 20px var(--accent);
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(239, 87, 119, 0.7); } 70% { box-shadow: 0 0 0 20px rgba(239, 87, 119, 0); } 100% { box-shadow: 0 0 0 0 rgba(239, 87, 119, 0); } }

    </style>
</head>
<body>

    <div id="start-overlay">
        <h1 style="color: var(--gold); margin-bottom: 30px;">ğŸ” ØºØ±ÙØ© Ø§Ù„Ù‡Ø±ÙˆØ¨ Ø§Ù„ÙƒÙŠÙ…ÙŠØ§Ø¦ÙŠØ©</h1>
        <button id="start-btn" onclick="startChallenge()">Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ­Ø¯ÙŠ ğŸ”Š</button>
        <p style="color: #aaa; margin-top: 20px;">ØªØ£ÙƒØ¯ Ù…Ù† Ø±ÙØ¹ ØµÙˆØª Ø§Ù„Ø¬Ù‡Ø§Ø²</p>
    </div>

    <header>
        <div class="school-name">Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø´ÙŠØ® Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø¨Ù† Ø¨Ø´ÙŠØ± Ø§Ù„Ø­Ø¶Ø±Ù…ÙŠ</div>
        <div class="developer-name">ØªØ·ÙˆÙŠØ± Ø£.ÙŠØ­ÙŠÙ‰ Ø§Ù„ÙƒØ´Ø±ÙŠ</div>
    </header>

    <div class="timer-container">
        <svg class="timer-svg" viewBox="0 0 100 100">
            <circle class="circle-bg" cx="50" cy="50" r="45"></circle>
            <circle class="circle-progress" id="progress-ring" cx="50" cy="50" r="45"></circle>
        </svg>
        <div class="timer-text" id="timer-label">05:00</div>
    </div>

    <div class="puzzle-area">
        <div class="column">
            <div class="question-box">Ù…Ø§ Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø°Ø±ÙŠ Ù„Ø¹Ù†ØµØ±<br>(Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© 1ØŒ Ø§Ù„Ø¯ÙˆØ±Ø© 3)ØŸ</div>
            <div class="long-line"></div>
        </div>
        <div class="column">
            <div class="question-box">Ù…Ø§ ØªÙƒØ§ÙØ¤ Ø¹Ù†ØµØ± Ø§Ù„ÙƒÙ„ÙˆØ±ØŸ</div>
            <div class="long-line"></div>
        </div>
        <div class="column">
            <div class="question-box">ÙƒÙ… Ø¹Ø¯Ø¯ Ø§Ù„Ø°Ø±Ø§Øª ÙÙŠ<br>Ù…Ø±ÙƒØ¨ NaClØŸ</div>
            <div class="long-line"></div>
        </div>
    </div>

    <div class="lock-housing">
        <input type="text" class="code-input" id="inp1" maxlength="2" placeholder="--">
        <input type="text" class="code-input" id="inp2" maxlength="1" placeholder="-">
        <input type="text" class="code-input" id="inp3" maxlength="1" placeholder="-">
    </div>

    <button class="submit-btn" onclick="checkCode()">ÙØªØ­ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚</button>

    <div class="chest-wrapper" id="chest">
        <div class="success-msg">ğŸ‰ Ø£Ø­Ø³Ù†ØªÙ…! Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©</div>
        <div class="chest-body"></div>
        <div class="chest-lid">
            <div class="chest-lock"></div>
        </div>
    </div>

    <script>
        const TOTAL_TIME = 300; // 5 Ø¯Ù‚Ø§Ø¦Ù‚
        let timeLeft = TOTAL_TIME;
        let timerInterval;
        let audioCtx;
        
        const ANSWERS = ["11", "1", "2"];

        function startChallenge() {
            document.getElementById('start-overlay').style.display = 'none';
            
            // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙˆØª (Web Audio API) Ø¨ØµÙˆØª Ù…Ø±ØªÙØ¹
            const AudioContext = window.AudioContext || window.webkitAudioContext;
            audioCtx = new AudioContext();
            
            startTimer();
        }

        function startTimer() {
            const circle = document.getElementById('progress-ring');
            const radius = circle.r.baseVal.value;
            const circumference = radius * 2 * Math.PI;
            const label = document.getElementById('timer-label');

            circle.style.strokeDasharray = `${circumference} ${circumference}`;

            // ØªØ´ØºÙŠÙ„ Ø£ÙˆÙ„ Ø¯Ù‚Ø© ÙÙˆØ±Ø§Ù‹
            playTick(timeLeft % 2 === 0);

            timerInterval = setInterval(() => {
                timeLeft--;
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆÙ‚Øª
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                label.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¯Ø§Ø¦Ø±Ø©
                const offset = circumference - (timeLeft / TOTAL_TIME) * circumference;
                circle.style.strokeDashoffset = offset;

                // ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª (ØªÙŠÙƒ-ØªÙˆÙƒ)
                if (timeLeft > 0) {
                    playTick(timeLeft % 2 === 0);
                } else {
                    playAlarm(); // ØµÙˆØª Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ÙˆÙ‚Øª
                    clearInterval(timerInterval);
                    label.style.color = "red";
                    alert("â° Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª!");
                }
            }, 1000);
        }

        // Ø¯Ø§Ù„Ø© ØªÙˆÙ„ÙŠØ¯ ØµÙˆØª Ø§Ù„ØªÙŠÙƒ ØªÙˆÙƒ (Ø¹Ø§Ù„ÙŠ ÙˆÙˆØ§Ø¶Ø­)
        function playTick(isHighPitch) {
            if (!audioCtx) return;
            
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();

            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);

            // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙˆØ¬Ø© Ù…Ø±Ø¨Ø¹Ø© Ù„ØµÙˆØª Ø­Ø§Ø¯ ÙˆÙ‚ÙˆÙŠ
            osc.type = 'square';
            
            // Ø§Ù„ØªØ±Ø¯Ø¯: Ø¹Ø§Ù„ÙŠ ÙˆÙ…Ù†Ø®ÙØ¶ Ù„Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ø³Ø§Ø¹Ø©
            osc.frequency.setValueAtTime(isHighPitch ? 800 : 600, audioCtx.currentTime);
            
            // Ø±ÙØ¹ Ø§Ù„ØµÙˆØª (Gain) Ù„ÙŠÙƒÙˆÙ† Ù…Ø³Ù…ÙˆØ¹Ø§Ù‹
            gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime); // 50% volume (loud)
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);

            osc.start();
            osc.stop(audioCtx.currentTime + 0.1); // Ù…Ø¯Ø© Ù‚ØµÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹
        }

        function playAlarm() {
            if (!audioCtx) return;
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(400, audioCtx.currentTime);
            gain.gain.value = 0.8;
            osc.start();
            osc.stop(audioCtx.currentTime + 1);
        }

        function playWinSound() {
            if (!audioCtx) return;
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.type = 'triangle';
            
            // Ù†ØºÙ…Ø© Ø§Ù„ÙÙˆØ²
            osc.frequency.setValueAtTime(523.25, audioCtx.currentTime); // Do
            osc.frequency.setValueAtTime(659.25, audioCtx.currentTime + 0.2); // Mi
            osc.frequency.setValueAtTime(783.99, audioCtx.currentTime + 0.4); // Sol
            osc.frequency.setValueAtTime(1046.50, audioCtx.currentTime + 0.6); // High Do
            
            gain.gain.setValueAtTime(0.5, audioCtx.currentTime);
            gain.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 1.5);
            
            osc.start();
            osc.stop(audioCtx.currentTime + 1.5);
        }

        function checkCode() {
            const v1 = document.getElementById('inp1').value.trim();
            const v2 = document.getElementById('inp2').value.trim();
            const v3 = document.getElementById('inp3').value.trim();
            const inputs = [document.getElementById('inp1'), document.getElementById('inp2'), document.getElementById('inp3')];

            if (v1 === ANSWERS[0] && v2 === ANSWERS[1] && v3 === ANSWERS[2]) {
                // âœ… ÙÙˆØ²
                document.getElementById('chest').classList.add('chest-open');
                playWinSound();
                clearInterval(timerInterval); // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ÙˆÙ‚Øª
                document.querySelector('.submit-btn').style.display = 'none';
                
                inputs.forEach(i => {
                    i.style.borderColor = "#4cd137";
                    i.style.color = "#4cd137";
                    i.disabled = true;
                });

            } else {
                // âŒ Ø®Ø·Ø£
                // ØµÙˆØª Ø®Ø·Ø£ Ø³Ø±ÙŠØ¹
                if(audioCtx) {
                    const o = audioCtx.createOscillator();
                    const g = audioCtx.createGain();
                    o.connect(g); g.connect(audioCtx.destination);
                    o.type = 'sawtooth'; o.frequency.value = 150; 
                    g.gain.value = 0.8;
                    o.start(); o.stop(audioCtx.currentTime + 0.2);
                }

                // Ø­Ø±ÙƒØ© Ø§Ù‡ØªØ²Ø§Ø²
                const housing = document.querySelector('.lock-housing');
                housing.style.transform = "translateX(10px)";
                setTimeout(() => housing.style.transform = "translateX(-10px)", 100);
                setTimeout(() => housing.style.transform = "translateX(0)", 200);
                
                if(v1 !== ANSWERS[0]) inputs[0].style.borderColor = "red";
                if(v2 !== ANSWERS[1]) inputs[1].style.borderColor = "red";
                if(v3 !== ANSWERS[2]) inputs[2].style.borderColor = "red";
                
                setTimeout(() => {
                    inputs.forEach(i => i.style.borderColor = "#576574");
                }, 1000);
            }
        }
    </script>
</body>
</html>